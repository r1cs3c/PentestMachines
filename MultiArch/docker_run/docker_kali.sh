#!/bin/bash
# Run Kali_test machine
machine_name="kali_MacOs"
ram_mem="4G"
image="r1cs3c/kali_build:latest"
dir_to_share="$(PWD)"

#Docker without VPN support
docker run -d --name $machine_name -h "kali.test" --memory $ram_mem -v "/tmp/":/src/temp/ -v $dir_to_share:/src/home -p 3391:3390 -ti $image bash -c "service xrdp restart; /bin/zsh"

# Docker command to allow vpn connections - privilege access and NET_ADMIN, no ipv6 support
#docker run -d --name $machine_name -h "kali.test" --privileged --cap-add=NET_ADMIN --sysctl net.ipv6.conf.all.disable_ipv6=0 --memory $ram_mem -v "/tmp/":/src/temp/ -v "/Users/rcampo/OneDrive - Cochlear Ltd/opt":/opt/ -v "/Users/rcampo/BurpFiles":/src/BurpFiles -v "/Users/rcampo/WorkingDir":/src/WorkingDir -p 3391:3390 -ti $image bash -c "service xrdp restart; /bin/bash"